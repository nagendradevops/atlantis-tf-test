version: 3
projects:
- name: my-project-name
  dir: proj1
  workspace: default
  terraform_version: v0.11.0
  autoplan:
    enabled: true
    when_modified: ["*.tf", "../modules/**/*.tf"]
    
  workflow: myworkflow
workflows:
  myworkflow:
    plan:
      steps:
      - run: rm -rf .terraform
      - run: terraform init -no-color -reconfigure -input=false
      - run: terraform plan -lock=false  -out $PLANFILE
      - run: echo plandone
    apply:
      steps:
      - run: echo apply
      - apply
