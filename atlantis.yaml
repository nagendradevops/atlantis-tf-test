version: 3
projects:
- name: my-project-name
  dir: proj1
  workspace: default
  terraform_version: v0.14.0
  autoplan:
    when_modified: ["*.tf"]
    enabled: true
  workflow: myworkflow
workflows:
  myworkflow:
    plan:
      steps:
      - run: rm -rf .terraform
      - run: terraform init -no-color -reconfigure -input=false
      - run: terraform plan -lock=false  -out $PLANFILE
      - run: terraform show -json $PLANFILE > $SHOWFILE
    apply:
      steps:
      - run: echo hi
      - apply
# allowed_regexp_prefixes:
# - dev/
# - staging/